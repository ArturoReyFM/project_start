<!DOCTYPE html>
<html lang="es-419">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Control de bomba de agua</title>
    <link rel="stylesheet" href="{{ url_for('static',filename='styles/style.css') }}" />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap"
      rel="stylesheet" />
    <!-- Icons made by https://www.freepik.com from https://www.flaticon.com -->
  </head>

  <body>
    <!-- Glass circles -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js"
      type="text/javascript"></script>
    <script src="{{ url_for('static',filename='js/mqttOperaciones.js') }}"></script>
    <script src="{{ url_for('static',filename='js/app.js') }}" type="module"></script>
    <div class="vidrio"></div>
    <div class="vidrio"></div>

    <main class="vidrio main" v-scope @vue:mounted="addListeners()">
      <h1 class="title">Bomba de agua</h1>
      <p class="notification">{{notificacion}}</p>
      <div class="grid-container">
        <section class="section">
          <h2 class="subtitle">Niveles de agua</h2>
          <div class="level-info">
            <div class="level-info-top">
              <p class="information">
                Abajo:
                <span id="nivel_tambo">
                  {% raw %} {{ !nivelTambo 
                    ? '--' 
                    : nivelTambo < 0 
                    ? 0+'%' 
                    :nivelTambo+'%' }} {% endraw %} </span>
              </p>
              <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                <g>
                  <path
                    d="m473.574 252.432h-73.184v-43.761c0-11.473-9.334-20.807-20.807-20.807-9.886 0-34.295 0-44.302 0v-17.841c0-12.399-10.087-22.486-22.486-22.486h-17.595l14.724-47.535c16.759.692 30.539-12.75 30.539-29.284 0-16.164-13.151-29.315-29.315-29.315-29.268 0-40.455 38.51-15.541 54.154l-16.101 51.979h-30.133c-10.576 0-19.831 7.514-22.006 17.866-.106.507-.16 1.024-.16 1.542v20.919h-38.146v-18.801c0-8.673-7.057-15.73-15.73-15.73h-1.379v-19.572c9.469-.203 17.113-7.953 17.113-17.47v-15.616c0-9.517-7.644-17.267-17.113-17.47v-43.699c0-21.695-17.65-39.346-39.346-39.346h-51.677c-4.14 0-7.495 3.356-7.495 7.495s3.356 7.495 7.495 7.495h51.678c13.429 0 24.355 10.926 24.355 24.355v43.682h-37.957v-22.584c0-4.14-3.356-7.495-7.495-7.495h-96.2v-37.957h35.638c4.14 0 7.495-3.356 7.495-7.495s-3.355-7.495-7.495-7.495h-43.133c-4.14 0-7.495 3.356-7.495 7.495v52.947c0 4.14 3.356 7.495 7.495 7.495h96.2v15.109c-9.468.203-17.112 7.954-17.112 17.47v15.616c0 9.516 7.644 17.267 17.112 17.47v19.572h-1.379c-8.673 0-15.73 7.057-15.73 15.73v18.801h-22.555c-11.473 0-20.807 9.334-20.807 20.807v2.489l-33.402 7.589c-3.413.775-5.835 3.809-5.835 7.309v107.243c0 3.499 2.421 6.533 5.833 7.308l33.404 7.598v2.487c0 11.473 9.334 20.807 20.807 20.807h6.424v27.799h-15.127c-4.14 0-7.495 3.356-7.495 7.495 0 4.14 3.356 7.495 7.495 7.495h333.849c1.378 0 2.498 1.121 2.498 2.498v25.52c-15.836-2.83-32.418.103-46.707 8.811-16.754 10.211-37.57 10.212-54.324 0-21.567-13.144-48.361-13.145-69.928 0-16.754 10.211-37.57 10.212-54.324 0-21.567-13.144-48.361-13.145-69.928 0-16.754 10.212-37.57 10.212-54.324 0l-27.469-16.742v-20.087h10.676c4.14 0 7.495-3.356 7.495-7.495s-3.356-7.495-7.495-7.495h-18.172c-4.14 0-7.495 3.356-7.495 7.495v97.549c0 4.139 3.356 7.495 7.495 7.495h497.009c4.14 0 7.495-3.356 7.495-7.495 0-88.506 0-118.009 0-213.487.001-21.188-17.237-38.426-38.425-38.426zm-162.425-196.037c7.898 0 14.325 6.426 14.325 14.324s-6.426 14.325-14.325 14.325c-7.898 0-14.324-6.426-14.324-14.325s6.426-14.324 14.324-14.324zm-267.604 276.44-24.247-5.515v-95.277l24.247-5.509zm198.653-164.974c.947-3.125 3.867-5.333 7.176-5.333h63.42c4.133 0 7.495 3.362 7.495 7.495v17.841h-78.091zm-140.305-51.569v-15.616c0-1.378 1.121-2.498 2.498-2.498h67.185c1.378 0 2.498 1.121 2.498 2.498v15.616c0 1.378-1.121 2.498-2.498 2.498h-67.185c-1.377.001-2.498-1.12-2.498-2.498zm55.069 17.489v19.553h-37.957v-19.553zm-55.066 35.283c0-.407.332-.739.739-.739h70.696c.407 0 .739.332.739.739v18.801h-72.175v-18.801zm-.003 33.791h240.148v153.656h-240.148zm-37.542 153.656c-3.207 0-5.816-2.609-5.816-5.816v-142.023c0-3.207 2.609-5.816 5.816-5.816h22.551v153.656c-5.211-.001-17.488-.001-22.551-.001zm299.372 42.79h-277.957v-27.799h277.956v27.799zm7.495-42.794c-.029 0-.058.004-.087.004h-14.099v-153.656h22.551c3.207 0 5.816 2.609 5.816 5.816v142.024c0 3.207-2.609 5.816-5.816 5.816h-8.278c-.029 0-.058-.004-.087-.004zm125.791 140.343c-9.379 0-471.107 0-482.019 0v-44.916l19.667 11.987c21.567 13.145 48.361 13.145 69.928 0 16.754-10.211 37.57-10.212 54.324 0 21.568 13.145 48.361 13.145 69.928 0 16.754-10.211 37.57-10.212 54.324 0 21.568 13.145 48.361 13.145 69.928 0 17.097-10.421 37.941-9.986 54.324 0 21.567 13.144 48.362 13.144 69.928 0l19.667-11.987c.001 10.556.001 22.38.001 44.916zm0-62.472c-29.789 18.156-30.353 18.836-36.527 21.132v-44.257c0-4.139-3.356-7.495-7.495-7.495s-7.495 3.356-7.495 7.495v47.427c-19.472 1.172-28.984-7.688-38.506-11.836v-30.054c0-9.643-7.846-17.489-17.489-17.489h-10.783v-27.799c13.342 0 21.676-10.049 21.676-20.807v-31.755h45.102v62.331c0 4.139 3.356 7.495 7.495 7.495s7.495-3.356 7.495-7.495v-69.826c0-4.139-3.356-7.495-7.495-7.495h-52.597v-36.527h73.184c12.923 0 23.436 10.513 23.436 23.435v143.52z" />
                  <path
                    d="m211.024 227.153h-79.726c-4.14 0-7.495 3.356-7.495 7.495v90.07c0 4.14 3.356 7.495 7.495 7.495h79.726c4.14 0 7.495-3.356 7.495-7.495v-90.07c.001-4.139-3.355-7.495-7.495-7.495zm-7.495 90.07h-64.735v-75.079h64.735z" />
                  <path
                    d="m312.635 240.97h-64.505c-4.139 0-7.495 3.356-7.495 7.495 0 4.14 3.356 7.495 7.495 7.495h64.505c4.139 0 7.495-3.356 7.495-7.495.001-4.139-3.355-7.495-7.495-7.495z" />
                  <path
                    d="m312.635 272.188h-64.505c-4.139 0-7.495 3.356-7.495 7.495s3.356 7.495 7.495 7.495h64.505c4.139 0 7.495-3.356 7.495-7.495s-3.355-7.495-7.495-7.495z" />
                  <path
                    d="m312.635 303.406h-64.505c-4.139 0-7.495 3.356-7.495 7.495s3.356 7.495 7.495 7.495h64.505c4.139 0 7.495-3.356 7.495-7.495s-3.355-7.495-7.495-7.495z" />
                  <path
                    d="m161.899 287.179h7.548l-2.904 7.432c-1.507 3.855.397 8.202 4.253 9.709.896.35 1.819.516 2.726.516 2.997 0 5.826-1.809 6.983-4.769l6.9-17.655c.902-2.307.606-4.91-.791-6.955s-3.713-3.268-6.19-3.268h-7.548l2.904-7.432c1.507-3.855-.397-8.202-4.253-9.709-3.855-1.509-8.203.396-9.709 4.253l-6.9 17.655c-.902 2.307-.606 4.91.791 6.955 1.396 2.044 3.713 3.268 6.19 3.268z" />
                </g>
              </svg>
            </div>
            <div class="progress-container"></div>
            <div
              class="progress"
              :style="{ width: !nivelTambo ? '0%' : nivelTambo > 100 ? 100+'%' :
                  nivelTambo < 0 ? 0+'%' : nivelTambo+'%' }"></div>
          </div>
          <div class="level-info">
            <div class="level-info-top">
              <p class="information">
                Arriba:
                <span id="nivel_tinaco"
                  >{% raw %} {{ !nivelTinaco ? '--' : nivelTinaco < 0 ? 0+'%' :
                  nivelTinaco+'%' }} {% endraw %}</span
                >
              </p>
              <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                <g>
                  <path
                    d="m504.485 329.247h-125.264v-17.185c73.878-3.919 132.779-65.255 132.779-140.097 0-74.837-58.901-136.173-132.779-140.093v-9.328c0-12.431-10.113-22.544-22.544-22.544h-45.65c-12.431 0-22.544 10.113-22.544 22.544v9.125h-148.187c-43.511 0-83.84 19.693-110.647 54.029-2.554 3.271-1.972 7.994 1.299 10.548 3.27 2.555 7.993 1.974 10.548-1.299 23.938-30.662 59.949-48.248 98.799-48.248h19.536v250.537h-19.536c-69.072 0-125.266-56.194-125.266-125.27 0-18.473 3.925-36.257 11.664-52.861 1.753-3.762.125-8.232-3.636-9.986-3.762-1.752-8.232-.126-9.986 3.636-8.673 18.606-13.071 38.527-13.071 59.215 0 74.837 58.901 136.173 132.779 140.092v17.185h-125.264c-4.151 0-7.515 3.365-7.515 7.515v45.331c0 4.15 3.364 7.515 7.515 7.515h26.65v114.878c0 4.15 3.364 7.515 7.515 7.515h47.114c4.151 0 7.515-3.365 7.515-7.515v-114.879h50.49c4.151 0 7.515-3.364 7.515-7.515s-3.364-7.515-7.515-7.515h-131.77v-30.302h481.941v30.302h-320.113c-4.151 0-7.515 3.365-7.515 7.515s3.364 7.515 7.515 7.515h49.572v114.878c0 4.15 3.364 7.515 7.515 7.515h47.114c4.151 0 7.515-3.365 7.515-7.515v-114.878h127.118v114.878c0 4.15 3.364 7.515 7.515 7.515h47.114c4.151 0 7.515-3.365 7.515-7.515v-114.878h26.65c4.151 0 7.515-3.364 7.515-7.515v-45.331c0-4.15-3.364-7.514-7.515-7.514zm-423.206 167.724h-32.085v-107.364h32.085zm222.234-474.427c0-4.144 3.371-7.515 7.515-7.515h45.65c4.144 0 7.515 3.371 7.515 7.515v9.125h-60.679v-9.125zm-74.847 169.339h-53.805v-36.996h53.805zm0-52.026h-53.805v-36.996h53.805zm-53.805 67.055h53.805v36.996h-53.805zm53.805-160.213v41.133h-53.805v-41.133zm-53.805 212.238h53.805v38.298h-53.805zm-27.053 53.328h148.19c4.151 0 7.515-3.365 7.515-7.515s-3.364-7.515-7.515-7.515h-52.302v-250.536h128.009c69.072 0 125.266 56.194 125.266 125.271 0 69.072-56.194 125.266-125.266 125.266h-45.648c-4.151 0-7.515 3.365-7.515 7.515s3.364 7.515 7.515 7.515h38.135v16.982h-216.384zm125.736 184.706h-32.085v-107.364h32.085zm189.262 0h-32.085v-107.364h32.085z" />
                </g>
              </svg>
            </div>
            <div class="progress-container"></div>
            <div
              class="progress"
              :style="{ width: !nivelTinaco ? '0%' : nivelTinaco > 100 ? 100+'%' :
                  nivelTinaco < 0 ? 0+'%' : nivelTinaco+'%' }"></div>
          </div>
        </section>

        <fieldset class="section mode">
          <legend class="subtitle">Modo</legend>
          <div class="flex-mode radio-buttons">
            <div class="modo radio checked-label">
              <label for="automatico"
                ><input
                  type="radio"
                  name="modo"
                  id="automatico"
                  :checked="modo==='automatico'?true:false"
                  @click="mqttEvent('automatico')" />
                <div class="radio-label"></div>
                Automático</label
              >
            </div>

            <div class="modo radio checked-label">
              <label for="semi">
                <input
                  type="radio"
                  name="modo"
                  id="semi"
                  :checked="modo==='semiautomatico'?true:false"
                  @click="mqttEvent('semiautomatico')" />
                <div class="radio-label"></div>
                Semi-automático</label
              >
            </div>

            <div class="modo radio checked-label">
              <label for="manual">
                <input
                  type="radio"
                  name="modo"
                  id="manual"
                  :checked="modo==='manual'?true:false"
                  @click="mqttEvent('manual')" />
                <div class="radio-label"></div>
                Manual</label
              >
            </div>
          </div>
        </fieldset>

        <fieldset class="encender-apagar">
          <div class="switch btn-color-mode-switch" @click="mqttEvent($event)">
            <input
              type="checkbox"
              name="encenderApagarBomba"
              id="encenderApagarBomba"
              aria-label="Encender bomba"
              :disabled="modo==='automatico'?true:false" />
            <label
              for="encenderApagarBomba"
              class="btn-color-mode-switch-inner"></label>
            <div class="on-off-label">
              {% raw %}{{modo==="automatico" 
              ? "En modo automático"
              :isBombaActive
              ?"Encendida"
              :"Apagada"}}{% endraw %}
            </div>
          </div>
          <legend class="invisible">Encender o apagar la bomba</legend>
        </fieldset>
      </div>
    </main>
  </body>
</html>
